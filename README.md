# お金の貸し借り管理アプリ

二人（カップル）専用のお金の貸し借りを管理するWebアプリケーションです。

## 特徴

- 🔐 Googleログインによる認証（ホワイトリスト方式）
- 👥 二人それぞれの視点でデータを表示
- 💰 貸した・借りた・返済の記録
- 📊 リアルタイムでの収支確認
- 📱 スマホ最適化されたUI
- 🔄 返済の追跡（二重返済防止）

## 技術スタック

- **フロントエンド**: HTML, CSS, JavaScript（バニラJS）
- **バックエンド**: Supabase
- **認証**: Supabase Auth（Google OAuth）
- **データベース**: PostgreSQL（Supabaseが提供）

## ファイル構成

```
money-with-serena/
├── index.html           # メインアプリケーション（モックアップ版）
├── SETUP.md            # Supabaseセットアップ手順
├── DATABASE_DESIGN.md  # データベース設計書
└── README.md           # このファイル
```

## 使い方

### モックアップ版（現在）

1. `index.html`をブラウザで開く
2. 「あなた」または「彼女」を選択してログイン
3. 貸した・借りた・返すの記録を追加
4. ダッシュボードで収支を確認

**データ保存**: ブラウザのlocalStorageに保存されます

### 本番版（Supabase使用）

`SETUP.md`の手順に従ってSupabaseをセットアップしてください。

## 主な機能

### 1. トランザクション管理

- **貸した**: 相手にお金を貸した記録
- **借りた**: 相手からお金を借りた記録
- **返す**: 借りていたお金を返済（複数選択可能）

### 2. 視点の切り替え

User1とUser2でログインすると、同じデータが異なる視点で表示されます：

**例:**
- User1が「貸した ¥5,000」を記録
- User2でログインすると「借りた ¥5,000」として表示される

### 3. 返済機能

- 未返済の借りのみを一覧表示
- 複数の借りをまとめて返済可能
- 返済額が自動計算される
- 返済済みの借りは「返す」モーダルに表示されない

### 4. ダッシュボード

- 現在の収支
- 貸した合計
- 借りた合計
- ユーザーごとの詳細統計

## データベース設計

詳細は`DATABASE_DESIGN.md`を参照してください。

### 主要テーブル

#### transactions
```
- id: UUID
- user_email: 登録者のメール
- type: 'lend' | 'borrow' | 'repay'
- amount: 金額
- description: 説明
- date: 日付
- repaid: 返済済みフラグ（borrowのみ）
- repaid_transactions: 返済した借りのID（repayのみ）
```

#### allowed_emails
```
- id: UUID
- email: 許可されたメールアドレス
```

## セキュリティ

- ホワイトリストによるアクセス制御
- Row Level Security (RLS) によるデータ保護
- Google OAuth 2.0認証

## 今後の拡張案

- [ ] カテゴリ分類機能
- [ ] 統計グラフ表示
- [ ] CSVエクスポート
- [ ] 通知機能
- [ ] 複数カップル対応

## ライセンス

Private use only

## 開発者

このプロジェクトは、カップル専用の貸し借り管理ツールとして開発されました。
