<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ - ãŠé‡‘ã®è²¸ã—å€Ÿã‚Šç®¡ç†ã‚¢ãƒ—ãƒª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: white;
            font-size: 36px;
            margin-bottom: 16px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .subtitle {
            text-align: center;
            color: rgba(255, 255, 255, 0.9);
            font-size: 18px;
            margin-bottom: 40px;
        }

        .section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 24px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        h2 {
            font-size: 28px;
            color: #111827;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 3px solid #e5e7eb;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        h3 {
            font-size: 20px;
            color: #374151;
            margin: 24px 0 16px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .table-container {
            overflow-x: auto;
            margin: 20px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        th, td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }

        th {
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            color: #374151;
            font-size: 15px;
        }

        tbody tr:hover {
            background: #f9fafb;
        }

        tbody tr:last-child td {
            border-bottom: none;
        }

        .type-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            color: white;
        }

        .type-lend {
            background: #10b981;
        }

        .type-borrow {
            background: #ef4444;
        }

        .type-repay {
            background: #3b82f6;
        }

        .code-block {
            background: #1f2937;
            color: #f9fafb;
            padding: 20px;
            border-radius: 12px;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            line-height: 1.6;
            margin: 16px 0;
        }

        .json-key {
            color: #93c5fd;
        }

        .json-string {
            color: #86efac;
        }

        .json-number {
            color: #fbbf24;
        }

        .json-boolean {
            color: #fb923c;
        }

        .flow-diagram {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin: 24px 0;
            padding: 24px;
            background: #f9fafb;
            border-radius: 12px;
        }

        .flow-step {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .flow-number {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }

        .flow-content {
            flex: 1;
            background: white;
            padding: 16px 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .flow-title {
            font-weight: 600;
            color: #111827;
            margin-bottom: 4px;
        }

        .flow-description {
            color: #6b7280;
            font-size: 14px;
        }

        .formula {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 20px;
            border-radius: 8px;
            margin: 16px 0;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 15px;
            color: #78350f;
        }

        .formula strong {
            color: #92400e;
        }

        .example-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .example-grid {
                grid-template-columns: 1fr;
            }
        }

        .example-card {
            background: #f9fafb;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e5e7eb;
        }

        .example-card h4 {
            font-size: 16px;
            color: #111827;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e5e7eb;
        }

        .example-item {
            padding: 8px 0;
            color: #374151;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .example-label {
            color: #6b7280;
        }

        .example-value {
            font-weight: 600;
            color: #111827;
        }

        .example-value.positive {
            color: #10b981;
        }

        .example-value.negative {
            color: #ef4444;
        }

        .highlight-box {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border: 2px solid #667eea;
            padding: 24px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .highlight-box h4 {
            color: #667eea;
            font-size: 18px;
            margin-bottom: 12px;
        }

        .highlight-box p {
            color: #374151;
            line-height: 1.6;
        }

        .icon {
            font-size: 24px;
        }

        .note {
            background: #e0e7ff;
            border-left: 4px solid #667eea;
            padding: 16px;
            border-radius: 8px;
            margin: 16px 0;
            font-size: 14px;
            color: #3730a3;
            line-height: 1.6;
        }

        .data-example {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .data-row:last-child {
            border-bottom: none;
        }

        .data-label {
            color: #6b7280;
            font-weight: 500;
        }

        .data-value {
            color: #111827;
            font-weight: 600;
        }

        ul {
            margin: 16px 0;
            padding-left: 24px;
        }

        li {
            color: #374151;
            line-height: 1.8;
            margin: 8px 0;
        }

        .security-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }

        .security-item {
            background: #ecfdf5;
            border: 2px solid #10b981;
            padding: 20px;
            border-radius: 12px;
        }

        .security-item h4 {
            color: #059669;
            font-size: 16px;
            margin-bottom: 8px;
        }

        .security-item p {
            color: #065f46;
            font-size: 14px;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆæ›¸</h1>
        <p class="subtitle">ãŠé‡‘ã®è²¸ã—å€Ÿã‚Šç®¡ç†ã‚¢ãƒ—ãƒª</p>

        <!-- æ¦‚è¦ -->
        <div class="section">
            <h2><span class="icon">ğŸ“‹</span> æ¦‚è¦</h2>
            <p style="color: #374151; line-height: 1.8; font-size: 16px;">
                ã“ã®ã‚¢ãƒ—ãƒªã¯ã€äºŒäººï¼ˆã‚ãªãŸã¨å½¼å¥³ï¼‰ã®é–“ã®ãŠé‡‘ã®è²¸ã—å€Ÿã‚Šã‚’ç®¡ç†ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚<br>
                å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ<strong>è‡ªåˆ†ã®è¦–ç‚¹ã§ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã‚‰ã‚Œã‚‹</strong>ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚
            </p>
            <div class="highlight-box">
                <h4>ğŸ’¡ è¨­è¨ˆã®ç‰¹å¾´</h4>
                <p>
                    åŒã˜ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§ã‚‚ã€ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã£ã¦ã€Œè²¸ã—ãŸã€ã€Œå€Ÿã‚ŠãŸã€ãŒé€†è»¢ã—ã¦è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚<br>
                    ä¾‹ï¼šUser1ãŒã€Œè²¸ã—ãŸ Â¥5,000ã€â†’ User2ã‹ã‚‰è¦‹ã‚‹ã¨ã€Œå€Ÿã‚ŠãŸ Â¥5,000ã€
                </p>
            </div>
        </div>

        <!-- ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€  -->
        <div class="section">
            <h2><span class="icon">ğŸ“Š</span> ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ </h2>

            <h3>1ï¸âƒ£ allowed_emails ãƒ†ãƒ¼ãƒ–ãƒ«</h3>
            <p style="color: #6b7280; margin-bottom: 16px;">ãƒ­ã‚°ã‚¤ãƒ³ã‚’è¨±å¯ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç®¡ç†ã—ã¾ã™ã€‚</p>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>ã‚«ãƒ©ãƒ å</th>
                            <th>å‹</th>
                            <th>åˆ¶ç´„</th>
                            <th>èª¬æ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>id</code></td>
                            <td>uuid</td>
                            <td>PRIMARY KEY</td>
                            <td>è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ID</td>
                        </tr>
                        <tr>
                            <td><code>email</code></td>
                            <td>text</td>
                            <td>UNIQUE, NOT NULL</td>
                            <td>è¨±å¯ã•ã‚ŒãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</td>
                        </tr>
                        <tr>
                            <td><code>created_at</code></td>
                            <td>timestamptz</td>
                            <td>NOT NULL</td>
                            <td>ä½œæˆæ—¥æ™‚</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="data-example">
                <strong>ãƒ‡ãƒ¼ã‚¿ä¾‹ï¼š</strong>
                <div class="data-row">
                    <span class="data-label">id:</span>
                    <span class="data-value">123e4567-e89b-12d3-a456-426614174000</span>
                </div>
                <div class="data-row">
                    <span class="data-label">email:</span>
                    <span class="data-value">user1@gmail.com</span>
                </div>
                <div class="data-row">
                    <span class="data-label">created_at:</span>
                    <span class="data-value">2025-01-05T10:00:00Z</span>
                </div>
            </div>

            <h3>2ï¸âƒ£ transactions ãƒ†ãƒ¼ãƒ–ãƒ«</h3>
            <p style="color: #6b7280; margin-bottom: 16px;">ã™ã¹ã¦ã®è²¸ã—å€Ÿã‚Šãƒ»è¿”æ¸ˆã®è¨˜éŒ²ã‚’ä¿å­˜ã—ã¾ã™ã€‚</p>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>ã‚«ãƒ©ãƒ å</th>
                            <th>å‹</th>
                            <th>åˆ¶ç´„</th>
                            <th>èª¬æ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>id</code></td>
                            <td>uuid</td>
                            <td>PRIMARY KEY</td>
                            <td>è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ID</td>
                        </tr>
                        <tr>
                            <td><code>user_email</code></td>
                            <td>text</td>
                            <td>NOT NULL</td>
                            <td>è¨˜éŒ²ã‚’ç™»éŒ²ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</td>
                        </tr>
                        <tr>
                            <td><code>type</code></td>
                            <td>text</td>
                            <td>NOT NULL, CHECK</td>
                            <td>ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®ç¨®é¡: 'lend', 'borrow', 'repay'</td>
                        </tr>
                        <tr>
                            <td><code>amount</code></td>
                            <td>integer</td>
                            <td>NOT NULL</td>
                            <td>é‡‘é¡ï¼ˆå††ï¼‰</td>
                        </tr>
                        <tr>
                            <td><code>description</code></td>
                            <td>text</td>
                            <td>NOT NULL</td>
                            <td>èª¬æ˜ï¼ˆä¾‹: "ãƒ©ãƒ³ãƒä»£"ï¼‰</td>
                        </tr>
                        <tr>
                            <td><code>date</code></td>
                            <td>date</td>
                            <td>NOT NULL</td>
                            <td>å–å¼•æ—¥</td>
                        </tr>
                        <tr>
                            <td><code>repaid</code></td>
                            <td>boolean</td>
                            <td>NULLABLE</td>
                            <td>è¿”æ¸ˆæ¸ˆã¿ãƒ•ãƒ©ã‚°ï¼ˆborrowã®å ´åˆã®ã¿ä½¿ç”¨ï¼‰</td>
                        </tr>
                        <tr>
                            <td><code>repaid_transactions</code></td>
                            <td>text[]</td>
                            <td>NULLABLE</td>
                            <td>è¿”æ¸ˆã—ãŸå€Ÿã‚Šã®IDãƒªã‚¹ãƒˆï¼ˆrepayã®å ´åˆã®ã¿ä½¿ç”¨ï¼‰</td>
                        </tr>
                        <tr>
                            <td><code>created_at</code></td>
                            <td>timestamptz</td>
                            <td>NOT NULL</td>
                            <td>ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ— -->
        <div class="section">
            <h2><span class="icon">ğŸ’³</span> ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—</h2>

            <h3><span class="type-badge type-lend">LEND</span> è²¸ã—ãŸ</h3>
            <p style="color: #6b7280; margin: 12px 0;">ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç›¸æ‰‹ã«ãŠé‡‘ã‚’è²¸ã—ãŸã“ã¨ã‚’è¨˜éŒ²</p>
            <div class="code-block">
{
  <span class="json-key">"id"</span>: <span class="json-string">"abc123"</span>,
  <span class="json-key">"user_email"</span>: <span class="json-string">"user1@gmail.com"</span>,
  <span class="json-key">"type"</span>: <span class="json-string">"lend"</span>,
  <span class="json-key">"amount"</span>: <span class="json-number">5000</span>,
  <span class="json-key">"description"</span>: <span class="json-string">"ãƒ©ãƒ³ãƒä»£"</span>,
  <span class="json-key">"date"</span>: <span class="json-string">"2025-01-05"</span>,
  <span class="json-key">"repaid"</span>: <span class="json-boolean">null</span>,
  <span class="json-key">"repaid_transactions"</span>: <span class="json-boolean">null</span>
}
            </div>
            <div class="note">
                <strong>ğŸ“ æ³¨æ„ï¼š</strong> lendã‚¿ã‚¤ãƒ—ã§ã¯<code>repaid</code>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚
            </div>

            <h3><span class="type-badge type-borrow">BORROW</span> å€Ÿã‚ŠãŸ</h3>
            <p style="color: #6b7280; margin: 12px 0;">ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç›¸æ‰‹ã‹ã‚‰ãŠé‡‘ã‚’å€Ÿã‚ŠãŸã“ã¨ã‚’è¨˜éŒ²</p>
            <div class="code-block">
{
  <span class="json-key">"id"</span>: <span class="json-string">"def456"</span>,
  <span class="json-key">"user_email"</span>: <span class="json-string">"user2@gmail.com"</span>,
  <span class="json-key">"type"</span>: <span class="json-string">"borrow"</span>,
  <span class="json-key">"amount"</span>: <span class="json-number">3000</span>,
  <span class="json-key">"description"</span>: <span class="json-string">"æ˜ ç”»ä»£"</span>,
  <span class="json-key">"date"</span>: <span class="json-string">"2025-01-04"</span>,
  <span class="json-key">"repaid"</span>: <span class="json-boolean">false</span>,  <span style="color: #fbbf24;">â† æœªè¿”æ¸ˆ</span>
  <span class="json-key">"repaid_transactions"</span>: <span class="json-boolean">null</span>
}
            </div>
            <div class="note">
                <strong>ğŸ“ æ³¨æ„ï¼š</strong> borrowã‚¿ã‚¤ãƒ—ã§ã¯<code>repaid</code>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§è¿”æ¸ˆçŠ¶æ…‹ã‚’ç®¡ç†ã—ã¾ã™ï¼ˆåˆæœŸå€¤: falseï¼‰ã€‚
            </div>

            <h3><span class="type-badge type-repay">REPAY</span> è¿”æ¸ˆ</h3>
            <p style="color: #6b7280; margin: 12px 0;">ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå€Ÿã‚Šã¦ã„ãŸãŠé‡‘ã‚’è¿”æ¸ˆã—ãŸã“ã¨ã‚’è¨˜éŒ²</p>
            <div class="code-block">
{
  <span class="json-key">"id"</span>: <span class="json-string">"ghi789"</span>,
  <span class="json-key">"user_email"</span>: <span class="json-string">"user2@gmail.com"</span>,
  <span class="json-key">"type"</span>: <span class="json-string">"repay"</span>,
  <span class="json-key">"amount"</span>: <span class="json-number">3000</span>,
  <span class="json-key">"description"</span>: <span class="json-string">"è¿”æ¸ˆ"</span>,
  <span class="json-key">"date"</span>: <span class="json-string">"2025-01-05"</span>,
  <span class="json-key">"repaid"</span>: <span class="json-boolean">null</span>,
  <span class="json-key">"repaid_transactions"</span>: [<span class="json-string">"def456"</span>]  <span style="color: #fbbf24;">â† ã©ã®å€Ÿã‚Šã‚’è¿”ã—ãŸã‹</span>
}
            </div>
            <div class="note">
                <strong>ğŸ“ æ³¨æ„ï¼š</strong> repayã‚¿ã‚¤ãƒ—ã§ã¯<code>repaid_transactions</code>é…åˆ—ã«ã©ã®å€Ÿã‚Šï¼ˆborrowã®IDï¼‰ã‚’è¿”æ¸ˆã—ãŸã‹ã‚’è¨˜éŒ²ã—ã¾ã™ã€‚
            </div>
        </div>

        <!-- è¦–ç‚¹å¤‰æ› -->
        <div class="section">
            <h2><span class="icon">ğŸ”„</span> ãƒ‡ãƒ¼ã‚¿ã®è¦–ç‚¹å¤‰æ›</h2>
            <p style="color: #374151; line-height: 1.8; margin-bottom: 24px;">
                ã“ã®ã‚¢ãƒ—ãƒªã®æœ€å¤§ã®ç‰¹å¾´ã¯ã€<strong>ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦–ç‚¹ã§ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹</strong>ã“ã¨ã§ã™ã€‚
            </p>

            <h3>è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯</h3>

            <div class="formula">
<strong>ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦–ç‚¹ã§ã®ã€Œè²¸ã—ãŸåˆè¨ˆã€</strong>
è‡ªåˆ†ãŒè²¸ã—ãŸåˆè¨ˆ =
  è‡ªåˆ†ãŒç™»éŒ²ã—ãŸ lend ã®åˆè¨ˆ +
  ç›¸æ‰‹ãŒç™»éŒ²ã—ãŸ borrow ã®åˆè¨ˆ
            </div>

            <div class="formula">
<strong>ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦–ç‚¹ã§ã®ã€Œå€Ÿã‚ŠãŸåˆè¨ˆã€</strong>
è‡ªåˆ†ãŒå€Ÿã‚ŠãŸåˆè¨ˆ =
  è‡ªåˆ†ãŒç™»éŒ²ã—ãŸ borrow ã®åˆè¨ˆ +
  ç›¸æ‰‹ãŒç™»éŒ²ã—ãŸ lend ã®åˆè¨ˆ
            </div>

            <div class="formula">
<strong>ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦–ç‚¹ã§ã®ã€Œè¿”æ¸ˆã—ãŸåˆè¨ˆã€</strong>
è‡ªåˆ†ãŒè¿”æ¸ˆã—ãŸåˆè¨ˆ =
  è‡ªåˆ†ãŒç™»éŒ²ã—ãŸ repay ã®åˆè¨ˆ
            </div>

            <div class="formula">
<strong>ç¾åœ¨ã®åæ”¯</strong>
åæ”¯ = è‡ªåˆ†ãŒè²¸ã—ãŸåˆè¨ˆ - è‡ªåˆ†ãŒå€Ÿã‚ŠãŸåˆè¨ˆ + è‡ªåˆ†ãŒè¿”æ¸ˆã—ãŸåˆè¨ˆ
     = (è‡ªåˆ†ã®lend + ç›¸æ‰‹ã®borrow) - (è‡ªåˆ†ã®borrow + ç›¸æ‰‹ã®lend) + è‡ªåˆ†ã®repay
            </div>

            <h3>è¦–ç‚¹å¤‰æ›ã®ä¾‹</h3>
            <p style="color: #6b7280; margin: 16px 0;">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä»¥ä¸‹ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãŒã‚ã‚‹ã¨ã—ã¾ã™ï¼š</p>
            <ul>
                <li>User1ãŒç™»éŒ²: type='lend', amount=5000</li>
                <li>User2ãŒç™»éŒ²: type='borrow', amount=3000</li>
            </ul>

            <div class="example-grid">
                <div class="example-card">
                    <h4>ğŸ‘¤ User1ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸå ´åˆ</h4>
                    <div class="example-item">
                        <span class="example-label">è²¸ã—ãŸåˆè¨ˆ:</span>
                        <span class="example-value positive">Â¥8,000</span>
                    </div>
                    <div class="example-item" style="font-size: 12px; color: #9ca3af;">
                        <span>(è‡ªåˆ†ã®lend Â¥5,000 + ç›¸æ‰‹ã®borrow Â¥3,000)</span>
                    </div>
                    <div class="example-item">
                        <span class="example-label">å€Ÿã‚ŠãŸåˆè¨ˆ:</span>
                        <span class="example-value">Â¥0</span>
                    </div>
                    <div class="example-item">
                        <span class="example-label">åæ”¯:</span>
                        <span class="example-value positive">+Â¥8,000</span>
                    </div>
                </div>

                <div class="example-card">
                    <h4>ğŸ‘© User2ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸå ´åˆ</h4>
                    <div class="example-item">
                        <span class="example-label">è²¸ã—ãŸåˆè¨ˆ:</span>
                        <span class="example-value">Â¥0</span>
                    </div>
                    <div class="example-item">
                        <span class="example-label">å€Ÿã‚ŠãŸåˆè¨ˆ:</span>
                        <span class="example-value negative">Â¥8,000</span>
                    </div>
                    <div class="example-item" style="font-size: 12px; color: #9ca3af;">
                        <span>(è‡ªåˆ†ã®borrow Â¥3,000 + ç›¸æ‰‹ã®lend Â¥5,000)</span>
                    </div>
                    <div class="example-item">
                        <span class="example-label">åæ”¯:</span>
                        <span class="example-value negative">-Â¥8,000</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- è¿”æ¸ˆãƒ•ãƒ­ãƒ¼ -->
        <div class="section">
            <h2><span class="icon">ğŸ’°</span> è¿”æ¸ˆãƒ•ãƒ­ãƒ¼</h2>

            <div class="flow-diagram">
                <div class="flow-step">
                    <div class="flow-number">1</div>
                    <div class="flow-content">
                        <div class="flow-title">å€Ÿã‚Šã®ä½œæˆ</div>
                        <div class="flow-description">
                            borrowã‚¿ã‚¤ãƒ—ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆï¼ˆrepaid: falseï¼‰
                        </div>
                    </div>
                </div>

                <div class="flow-step">
                    <div class="flow-number">2</div>
                    <div class="flow-content">
                        <div class="flow-title">è¿”æ¸ˆãƒ¢ãƒ¼ãƒ€ãƒ«ã§é¸æŠ</div>
                        <div class="flow-description">
                            æœªè¿”æ¸ˆã®å€Ÿã‚Šï¼ˆrepaid: falseï¼‰ã®ã¿ã‚’ä¸€è¦§è¡¨ç¤ºã—ã€è¿”æ¸ˆã™ã‚‹å€Ÿã‚Šã‚’ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã§é¸æŠ
                        </div>
                    </div>
                </div>

                <div class="flow-step">
                    <div class="flow-number">3</div>
                    <div class="flow-content">
                        <div class="flow-title">è¿”æ¸ˆãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ</div>
                        <div class="flow-description">
                            repayã‚¿ã‚¤ãƒ—ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã€repaid_transactionsã«å€Ÿã‚Šã®IDã‚’è¨˜éŒ²
                        </div>
                    </div>
                </div>

                <div class="flow-step">
                    <div class="flow-number">4</div>
                    <div class="flow-content">
                        <div class="flow-title">å€Ÿã‚Šã‚’è¿”æ¸ˆæ¸ˆã¿ã«ãƒãƒ¼ã‚¯</div>
                        <div class="flow-description">
                            è©²å½“ã™ã‚‹borrowãƒ¬ã‚³ãƒ¼ãƒ‰ã®repaidã‚’trueã«æ›´æ–°ï¼ˆäºŒé‡è¿”æ¸ˆã‚’é˜²æ­¢ï¼‰
                        </div>
                    </div>
                </div>
            </div>

            <div class="highlight-box">
                <h4>ğŸ”’ äºŒé‡è¿”æ¸ˆã®é˜²æ­¢</h4>
                <p>
                    <code>repaid: true</code>ã«ãªã£ãŸå€Ÿã‚Šã¯ã€è¿”æ¸ˆãƒ¢ãƒ¼ãƒ€ãƒ«ã«è¡¨ç¤ºã•ã‚Œãªããªã‚Šã¾ã™ã€‚<br>
                    ã“ã‚Œã«ã‚ˆã‚Šã€åŒã˜å€Ÿã‚Šã‚’äºŒé‡ã«è¿”æ¸ˆã™ã‚‹ã“ã¨ã‚’é˜²ãã¾ã™ã€‚
                </p>
            </div>

            <h3>è¿”æ¸ˆã®å–ã‚Šæ¶ˆã—ï¼ˆå‰Šé™¤ï¼‰</h3>
            <p style="color: #6b7280; margin: 16px 0;">è¿”æ¸ˆãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã™ã‚‹ã¨ã€ç´ä»˜ã‘ã‚‰ã‚ŒãŸå€Ÿã‚ŠãŒè‡ªå‹•çš„ã«æœªè¿”æ¸ˆã«æˆ»ã‚Šã¾ã™ã€‚</p>
            <div class="code-block">
-- 1. è¿”æ¸ˆãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤
DELETE FROM transactions WHERE id = 'è¿”æ¸ˆã®ID';

-- 2. ç´ä»˜ã‘ã‚‰ã‚ŒãŸå€Ÿã‚Šã‚’æœªè¿”æ¸ˆã«æˆ»ã™
UPDATE transactions
SET repaid = false
WHERE id IN (
  SELECT unnest(repaid_transactions)
  FROM transactions
  WHERE id = 'è¿”æ¸ˆã®ID'
);
            </div>
        </div>

        <!-- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ -->
        <div class="section">
            <h2><span class="icon">ğŸ”</span> ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</h2>

            <div class="security-grid">
                <div class="security-item">
                    <h4>âœ… ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆèªè¨¼</h4>
                    <p>allowed_emailsãƒ†ãƒ¼ãƒ–ãƒ«ã«ç™»éŒ²ã•ã‚ŒãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ã¿ãŒãƒ­ã‚°ã‚¤ãƒ³å¯èƒ½</p>
                </div>

                <div class="security-item">
                    <h4>âœ… Row Level Security (RLS)</h4>
                    <p>èªè¨¼ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ãŒãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ï¼ˆäºŒäººã—ã‹ä½¿ã‚ãªã„ãŸã‚å…¨å“¡ãŒå…¨ãƒ‡ãƒ¼ã‚¿ã‚’é–²è¦§å¯èƒ½ï¼‰</p>
                </div>

                <div class="security-item">
                    <h4>âœ… Google OAuth 2.0</h4>
                    <p>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¸è¦ã§å®‰å…¨ãªèªè¨¼ã‚’å®Ÿç¾</p>
                </div>

                <div class="security-item">
                    <h4>âœ… HTTPSé€šä¿¡</h4>
                    <p>Supabaseã¨ã®é€šä¿¡ã¯å…¨ã¦æš—å·åŒ–</p>
                </div>
            </div>
        </div>

        <!-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ -->
        <div class="section">
            <h2><span class="icon">âš¡</span> ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼‰</h2>
            <p style="color: #6b7280; margin-bottom: 20px;">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ¤œç´¢é€Ÿåº¦ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚</p>

            <div class="code-block">
-- æ—¥ä»˜é †ã®æ¤œç´¢ãŒé »ç¹ãªãŸã‚
CREATE INDEX idx_transactions_date
ON transactions(date DESC);

-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®æ¤œç´¢ç”¨
CREATE INDEX idx_transactions_user_email
ON transactions(user_email);

-- æœªè¿”æ¸ˆã®å€Ÿã‚Šã‚’æ¢ã™ç”¨ï¼ˆè¿”æ¸ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰
CREATE INDEX idx_transactions_repaid
ON transactions(repaid)
WHERE repaid = false;
            </div>
        </div>

        <!-- ã¾ã¨ã‚ -->
        <div class="section">
            <h2><span class="icon">âœ¨</span> ã¾ã¨ã‚</h2>
            <p style="color: #374151; line-height: 1.8; margin-bottom: 16px;">ã“ã®è¨­è¨ˆã«ã‚ˆã‚Šã€ä»¥ä¸‹ãŒå®Ÿç¾ã§ãã¦ã„ã¾ã™ï¼š</p>
            <ul>
                <li>âœ… äºŒäººãŒåŒã˜ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å…±æœ‰ã—ãªãŒã‚‰ã€ãã‚Œãã‚Œã®è¦–ç‚¹ã§é–²è¦§å¯èƒ½</li>
                <li>âœ… è¿”æ¸ˆã®è¿½è·¡ãŒå¯èƒ½ï¼ˆäºŒé‡è¿”æ¸ˆé˜²æ­¢ï¼‰</li>
                <li>âœ… è¿”æ¸ˆã®å–ã‚Šæ¶ˆã—ãŒå¯èƒ½ï¼ˆå…ƒã®çŠ¶æ…‹ã«æˆ»ã›ã‚‹ï¼‰</li>
                <li>âœ… ã‚»ã‚­ãƒ¥ã‚¢ãªã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ï¼ˆãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆ + RLSï¼‰</li>
                <li>âœ… æ‹¡å¼µæ€§ã‚’è€ƒæ…®ã—ãŸè¨­è¨ˆï¼ˆå°†æ¥çš„ãªæ©Ÿèƒ½è¿½åŠ ã«å¯¾å¿œå¯èƒ½ï¼‰</li>
            </ul>
        </div>
    </div>
</body>
</html>
